<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" >
  <title></title>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
       https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-analytics.js"></script>
  <!-- <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-firestore.js"></script> -->
  <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-database.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>


  <style type="text/css">
    .bar-legend li span {
        width: 1em;
        height: 1em;
        display: inline-block;
        margin-right: 5px;
    }

    .bar-legend {
        list-style: none;
    }
  </style>
</head>
<body>
  <canvas id="bar" width=400 height=400></canvas>
  <div id="legend"></div>
  <script>
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    var firebaseConfig = {
      apiKey: "AIzaSyBu9kPgODPW2AlSzcrIfylOOzHfxZkKhWw",
      authDomain: "hci-test-e04ea.firebaseapp.com",
      databaseURL: "https://hci-test-e04ea.firebaseio.com",
      projectId: "hci-test-e04ea",
      storageBucket: "hci-test-e04ea.appspot.com",
      messagingSenderId: "715817784666",
      appId: "1:715817784666:web:fd19bd463d03a6fc28cf63",
      measurementId: "G-EGE4LPGHY0"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();


    var db = firebase.database();

    // 開始繪製柱狀圖
    var ctx = document.getElementById('bar').getContext('2d');


    var bar = new Chart(ctx, {
      "type": "bar",
      "data": {
          "labels": [],
          "datasets": [{
              "label": "My First Dataset",
              "data": [],
              "fill": false,
              "backgroundColor": ["rgba(255, 99, 132, 0.2)", "rgba(255, 159, 64, 0.2)", "rgba(255, 205, 86, 0.2)", "rgba(75, 192, 192, 0.2)", "rgba(54, 162, 235, 0.2)", "rgba(153, 102, 255, 0.2)", "rgba(201, 203, 207, 0.2)"],
              // "borderColor": ["rgb(255, 99, 132)", "rgb(255, 159, 64)", "rgb(255, 205, 86)", "rgb(75, 192, 192)", "rgb(54, 162, 235)", "rgb(153, 102, 255)", "rgb(201, 203, 207)"],
              "borderWidth": 1,
          }]
      },
      "options": {
        "responsive": true,
        "maintainAspectRatio": false,
        "scales": {
            "yAxes": [{
                "ticks": {
                    "beginAtZero": true
                }
            }]
        }
      }
    });
    
    db.ref('/').on('value', elem => {

      let labels = [];
      for (let e in elem.val())
        labels = [...labels, e];

      let data = labels.map(e => elem.val()[e]);


      bar.data.labels = labels;
      bar.data.datasets[0].data = data;
      bar.update();

    });
    



  </script>
</body>
</html>